<html data-wf-domain="office-works.webflow.io" data-wf-page="5ca8eed43be192c60a7a42d3" data-wf-site="5ca8eed43be19295f17a42d2" data-wf-status="1">

  <head>
    <meta charset="utf-8" />
    <title>Office Works</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <script type="text/javascript">
      WebFont.load({
        google: {
          families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic"]
        }
      });

    </script>

    <script type="text/javascript">
      ! function(o, c) {
        var n = c.documentElement,
          t = " w-mod-";
        n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch")
      }(window, document);

    </script>

    <link rel="stylesheet" href="/style.css">
  </head>

  <body class="body bg-primary">
    <div class="container w-container">
      <!-- <h1 class="heading">Works Update</h1> -->
      <h3 class="text-center"> <span class="field-label">Date</span> <input class="text-center" id="upload-date" type="date" name="bday" value="{{dateToday}}"/></h3>



      <div>
        <div class="w-form">

          <form id="email-form" name="email-form" data-name="Email Form" class="form shadow"><label for="name" class="field-label">Category</label>

            <div class="radio-button-field w-radio"><input type="radio" id="radio-2" name="radio" value="New Construction" data-name="Radio" class="w-radio-input" /><label for="radio-2" class="w-form-label">New Construction</label></div>
            <div class="radio-button-field w-radio"><input type="radio" id="radio" name="radio" value="External Uplift (FHCC)" data-name="Radio" class="w-radio-input" /><label for="radio" class="w-form-label">External Uplift (FHCC)</label></div>
            <div class="radio-button-field w-radio"><input type="radio" id="radio-3" name="radio" value="Bunkers Works (FHCC)" data-name="Radio" class="w-radio-input" /><label for="radio-3" class="w-form-label">Bunkers Works (FHCC)</label></div>
            <div class="radio-button-field w-radio"><input type="radio" id="radio-4" name="radio" value="Material In" data-name="Radio" class="w-radio-input" /><label for="radio-4" class="w-form-label">Material In</label></div>
            <div class="radio-button-field w-radio d-none"><input type="radio" id="radio-5" name="radio" value="Labour Attendance" data-name="Radio" class="w-radio-input" /><label for="radio-5" class="w-form-label">Labour Attendance</label>
            </div>
            <input type="submit" value="Next" data-wait="Please wait..." class="form-button w-button" />
            <div class="w-form-done">
              <div>Thank you! Your submission has been received!</div>
            </div>
            <div class="w-form-fail">
              <div>Oops! Something went wrong while submitting the form.</div>
            </div>
          </form>

        </div>
      </div>
      <div>
        <div class="form new-form w-form d-none shadow">
          <form id="email-form-2" name="email-form-2" data-name="Email Form 2">
            <label for="name" class="field-label">New Construction</label>

            <label>Project Name</label>
            <select data-name="name" id="const-projName" name="field-7" required="" class="w-select">
              <option value>Select one...</option>
              <option value="Bunker 1 Washroom & FHCC">Bunker 1 Washroom</option>
              <option value="Bunker 1 Washroom & FHCC">Washrooms</option>
              <option value="Entrance main Gate & FHCC">Entrance main Gate</option>
              <option value="Car Park Shed & FHCC">Car Park Shed</option>
              <option value="FHCC Pathways & FHCC">FHCC Pathways</option>
              <option value="Unit Pathways & Unit">Unit Pathways</option>
              <option value="FHCC Mosque & FHCC">FHCC Mosque</option>
              <option value="OFC / UG Laying & FHCC">OFC / UG Laying</option>
              <option value="Unit Mosque & Unit">Unit Mosque</option>
              <option value="MT Washing Pit & Unit">MT Washing Pit</option>
              <option value="MT Shed & Unit">MT Shed</option>
              <option value="Cook House & Unit">Cook House</option>
              <option value="Dining Hall & Unit">Dining Hall</option>
              <option value="Stores in Hangers & Unit">Stores in Hangers</option>
              <option value="Quarter Gd & Unit">Quarter Gd</option>
              <option value="POL Store & Unit">POL Store</option>
              <option value="Metalled Road & Unit">Metalled Road in unit</option>
              <option value="Aluminimum Windows/Doors & Unit">Aluminimum Windows/Door</option>
              <option value="SM Bk 2 Water Tank & Unit">SM Bk 2 Water Tank</option>
              <option value="SM Bk 2 OAS Earth & Unit">SM Bk 2 OAS Earth</option>
              <option value="IPS Room & Unit">IPS Room</option>
              <option value="other & other">other... (please mention in remarks)</option>
            </select>

            <label>Responsibility</label>
            <select data-name="responsibility" id="const-resp" name="field-7" required="" class="w-select">
              <option value>Select one...</option>
              <option value="MES">MES</option>
              <option value="Juke Box">Juke Box</option>
              <option value="78 Sigs">78 Sigs</option>
              <option value="Pak Arab">Pak Arab</option>
              <option value="Other">Other</option>
            </select>

            <label>Work</label>
            <input autocomplete="off" data-name="work" type="text" class="w-input search-input" maxlength="256" name="field-2" placeholder="Roof shuttering done 60 %" id="const-work" required="" />
            <div class="work-suggestions div-block-6"></div>

            <label>Quantity</label>
            <input data-name="quantity" type="number" class="w-input" maxlength="256" name="field-2" placeholder="350" id="const-qty" required="" />

            <label>Unit</label>
            <select data-name="unit" id="const-unit" name="field-7" required="" class="w-select">
              <option value>Select one...</option>
              <option value="sft">sft</option>
              <option value="cft">cft</option>
              <option value="rft">rft</option>
              <option value="large bags">large bags</option>
              <option value="small bags">small bags</option>
              <option value="truck">truck</option>
              <option value="trolley">trolley</option>
              <option value="units">units</option>
              <option value="meters">meters</option>
              <option value="buckets">buckets</option>
              <option value="Other">Other (please mention in remarks)</option>
            </select>

            <label>Remarks</label>
            <input data-name="remarks" type="text" class="w-input" maxlength="256" name="field-2" placeholder="Work is in progress" id="const-remarks" required="" />

            <button type="submit" value="Submit" data-wait="Please wait..." class="form-button w-button">Submit</button>
            <button id="" type="button" value="X" data-wait="Please wait..." class="email-form-2-btn form-button bg-primary text-dark w-button border-dark">X</button>
          </form>

          <div class="w-form-done">
            <div>Thank you! Your submission has been received!</div>
          </div>
          <div class="w-form-fail">
            <div>Oops! Something went wrong while submitting the form.</div>
          </div>
        </div>
        <div class="form new-form w-form d-none shadow">
          <form id="email-form-3" name="email-form-2">
            <label for="name-4" class="field-label">External Uplift (FHCC)</label>

            <label>Project Name</label>
            <select data-name="name" id="ext-projName" name="field-7" required="" class="w-select">
              <option value>Select one...</option>
              <option value="Boundary Wall & FHCC">Boundary Wall</option>
              <option value="New Lintels & FHCC">New Lintels</option>
              <option value="Outdoor CCTV Installation & FHCC">Outdoor CCTV Installation</option>
              <option value="Outdoor Lights & FHCC">Outdoor Lights</option>
              <option value="Bunker 3 Themed Wall & FHCC">Bunker 3 Themed Wall</option>
              <option value="Grass Laying & FHCC">Grass Laying</option>
            </select>

            <label>Responsibility</label>
            <select data-name="responsibility" id="ext-resp" name="field-7" required="" class="w-select">
              <option value>Select one...</option>
              <option value="MES">MES</option>
              <option value="Juke Box">Juke Box</option>
              <option value="78 Sigs">78 Sigs</option>
              <option value="Pak Arab">Pak Arab</option>
              <option value="Other">Other</option>
            </select>

            <label>Work</label>
            <input autocomplete="off" data-name="work" type="text" class="w-input search-input" maxlength="256" name="field-2" placeholder="Roof shuttering done 60 %" id="ext-work" required="" />
            <div class="work-suggestions div-block-6"></div>

            <label>Quantity</label>
            <input data-name="quantity"  type="number" class="w-input" maxlength="256" name="field-2" placeholder="350" id="ext-qty" required="" />

            <label>Unit</label>
            <select data-name="unit" id="ext-unit" name="field-7" required="" class="w-select">
              <option value>Select one...</option>
              <option value="sft">sft</option>
              <option value="cft">cft</option>
              <option value="rft">rft</option>
              <option value="large bags">large bags</option>
              <option value="small bags">small bags</option>
              <option value="truck">truck</option>
              <option value="trolley">trolley</option>
              <option value="units">units</option>
              <option value="meters">meters</option>
              <option value="buckets">buckets</option>
              <option value="Other">Other (please mention in remarks)</option>
            </select>

            <label>Remarks</label>
            <input data-name="remarks" type="text" class="w-input" maxlength="256" name="field-2" placeholder="Work is in progress" id="ext-remarks" required="" />

            <button type="submit" value="Submit" data-wait="Please wait..." class="form-button w-button">Submit</button>
            <button id="" type="button" value="X" data-wait="Please wait..." class="email-form-2-btn form-button bg-primary text-dark w-button border-dark">X</button>

            </form>
          <div class="w-form-done">
            <div>Thank you! Your submission has been received!</div>
          </div>
          <div class="w-form-fail">
            <div>Oops! Something went wrong while submitting the form.</div>
          </div>
        </div>
        <div class="form new-form w-form d-none shadow">
          <form id="email-form-4" name="email-form-2">
            <label for="name-3" class="field-label">Bunkers Works (FHCC)</label>

            <label>Bunker Number</label>
            <select data-name="name" id="bunker-projName" name="field-6" required="" class="w-select">
              <option value="">Select one...</option>
              <option value="Bunker 1 & FHCC">1</option>
              <option value="Bunker 2 & FHCC">2</option>
              <option value="Bunker 3 & FHCC">3</option>
              <option value="Bunker 4 & FHCC">4</option>
              <option value="Bunker 5 & FHCC">5</option>
              <option value="Bunker 6 & FHCC">6</option>
            </select>

            <label>Responsibility</label>
            <select data-name="responsibility" id="bunker-resp" name="field-7" required="" class="w-select">
              <option value>Select one...</option>
              <option value="MES">MES</option>
              <option value="Juke Box">Juke Box</option>
              <option value="78 Sigs">78 Sigs</option>
              <option value="Pak Arab">Pak Arab</option>
              <option value="Other">Other</option>
            </select>

            <label>Work</label>
            <input autocomplete="off" data-name="work" type="text" class="w-input search-input" maxlength="256" name="field-3" placeholder="Wall putty etc" id="bunker-work" required="" />
            <div class="work-suggestions div-block-6"></div>

            <label>Quantity</label>
            <input data-name="quantity"  type="number" class="w-input" maxlength="256" name="field-2" placeholder="350" id="bunker-qty" required="" />

            <label>Unit</label>
            <select data-name="unit"  id="bunker-unit" name="field-7" required="" class="w-select">
              <option value>Select one...</option>
              <option value="sft">sft</option>
              <option value="cft">cft</option>
              <option value="rft">rft</option>
              <option value="large bags">large bags</option>
              <option value="small bags">small bags</option>
              <option value="truck">truck</option>
              <option value="trolley">trolley</option>
              <option value="units">units</option>
              <option value="meters">meters</option>
              <option value="buckets">buckets</option>
              <option value="Other">Other (please mention in remarks)</option>
            </select>

            <label>Remarks</label>
            <input data-name="remarks"  type="text" class="w-input" maxlength="256" name="field-3" placeholder="Any thing" id="bunker-remarks" />

            <button type="submit" value="Submit" data-wait="Please wait..." class="form-button w-button">Submit</button>
            <button id="" type="button" value="X" data-wait="Please wait..." class="email-form-2-btn form-button bg-primary text-dark w-button border-dark">X</button>

          </form>
          <div class="w-form-done">
            <div>Thank you! Your submission has been received!</div>
          </div>
          <div class="w-form-fail">
            <div>Oops! Something went wrong while submitting the form.</div>
          </div>
        </div>
        <div class="form new-form w-form d-none shadow">
          <form id="email-form-5" name="email-form-2" data-name="Email Form 2" class="form-2">

            <label for="name-2" class="field-label">Material In</label>

            <label>Project Name</label>
            <select data-name="name" id="mat-name" name="field-6" required="" class="w-select">
              <option value>Select one...</option>
              <option value="Bunkers & FHCC">Bunkers</option>
              <option value="Bunker Washroom & FHCC">Bunker Washroom</option>
              <option value="FHCC Complex & FHCC">FHCC Complex</option>
              <option value="Entrance main Gate & FHCC">Entrance main Gate</option>
              <option value="Car Park Shed & FHCC">Car Park Shed</option>
              <option value="FHCC Pathways & FHCC">FHCC Pathways</option>
              <option value="Unit Pathways & Unit">Unit Pathways</option>
              <option value="FHCC Mosque & FHCC">FHCC Mosque</option>
              <option value="OFC / UG Laying & FHCC">OFC / UG Laying</option>
              <option value="Unit Mosque & Unit">Unit Mosque</option>
              <option value="MT Washing Pit & Unit">MT Washing Pit</option>
              <option value="MT Shed & Unit">MT Shed</option>
              <option value="Cook House & Unit">Cook House</option>
              <option value="Dining Hall & Unit">Dining Hall</option>
              <option value="Stores in Hangers & Unit">Stores in Hangers</option>
              <option value="Quarter Gd & Unit">Quarter Gd</option>
              <option value="POL Store & Unit">POL Store</option>
              <option value="Metalled Road & Unit">Metalled Road in unit</option>
              <option value="Aluminimum Windows/Doors & Unit">Aluminimum Windows/Door</option>
              <option value="SM Bk 2 Water Tank & Unit">SM Bk 2 Water Tank</option>
              <option value="SM Bk 2 OAS Earth & Unit">SM Bk 2 OAS Earth</option>
              <option value="IPS Room & Unit">IPS Room</option>
              <option value="other & other">other... (please mention in remarks)</option>
            </select>

            <label>Owner</label>
            <select data-name="responsibility" id="mat-resp" name="field-7" required="" class="w-select">
              <option value="Juke Box">Juke Box</option>
              <option value="MES">MES</option>
              <option value="Pak Arab">Pak Arab</option>
              <option value="78 Sigs">78 Sigs</option>
              <option value="Other">Other</option>
            </select>

            <label>Material</label>
            <input autocomplete="off" data-name="work" type="text" class="text-field w-input search-input" maxlength="256" name="field-3" placeholder="Cement / Sand etc" id="mat-work" required="" />
            <div class="work-suggestions div-block-6"></div>

            <label>Quantity</label>
            <input type="number" class="w-input" maxlength="256" name="field-2" data-name="quantity" placeholder="350" id="mat-qty" required="" />

            <label>Unit</label>
            <select data-name="unit" id="mat-unit" name="field-7" required="" class="w-select">
              <option value>Select one...</option>
              <option value="sft">sft</option>
              <option value="cft">cft</option>
              <option value="rft">rft</option>
              <option value="large bags">large bags</option>
              <option value="small bags">small bags</option>
              <option value="truck">truck</option>
              <option value="trolley">trolley</option>
              <option value="units">units</option>
              <option value="meters">meters</option>
              <option value="buckets">buckets</option>
              <option value="Other">Other (please mention in remarks)</option>
            </select>

            <label>Remarks</label>
            <input data-name="remarks"  type="text" class="w-input" maxlength="256" name="field-3" placeholder="Any thing" id="mat-remarks" />

            <button type="submit" value="Submit" data-wait="Please wait..." class="form-button w-button">Submit</button>
            <button id="" type="button" value="X" data-wait="Please wait..." class="email-form-2-btn form-button bg-primary text-dark w-button border-dark">X</button>

          </form>
          <div class="w-form-done">
            <div>Thank you! Your submission has been received!</div>
          </div>
          <div class="w-form-fail">
            <div>Oops! Something went wrong while submitting the form.</div>
          </div>
        </div>
        <div class="form new-form w-form d-none shadow">
          <form id="email-form-2" name="email-form-2" data-name="Email Form 2"><label for="name-5" class="field-label">Labour Attendance</label><input type="text" class="w-input" maxlength="256" name="name-2" data-name="Name 2"
              placeholder="Name of Labour" id="name-2" /><input type="text" class="w-input" maxlength="256" name="field-3" placeholder="MES / JukeBox / Pak Arab etc" id="field-3" required="" /><input type="text" class="w-input"
              maxlength="256" name="field-3" placeholder="Present / Absent" id="field-3" required="" /><input type="submit" value="Submit" data-wait="Please wait..." class="form-button w-button" /><input type="submit" value="Next"
              data-wait="Please wait..." class="form-button bg-success w-button" /></form>
          <div class="w-form-done">
            <div>Thank you! Your submission has been received!</div>
          </div>
          <div class="w-form-fail">
            <div>Oops! Something went wrong while submitting the form.</div>
          </div>
        </div>
      </div>

      <div class="category-block bg-primary">

      </div>

      <div class="div-block-4 bg-secondary d-none" style="position:relative">
        <div class="overlay border-dark bg-dark d-none" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)">
          <h3 class="saving" style="position:absolute;top:20%;left:50%;transform:translate(-50%,-50%);color:white;z-index:2">Saving</h3>
          <div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>
        </div>
        <div class="div-block-5">
          <div><h5><strong class="bold-text-2">Category: New Construction / Washrooms / External Repairs</strong></h5></div>
        </div>
        <button type="button" class="btn-submit button bg-success w-button">Submit</button>
        <button type="button" class="btn-delete button btn-danger w-button">Delete</button>
        <p class="error d-none"></p>

      </div>

      <div class="text-3"><strong></strong> <span></span> </div>

      <div class="form w-form shadow" style="position:relative">

        <label for="" class="field-label">Today's Updates</label>
        <button id="showFHCCData" type="button" value="Submit" data-wait="Please wait..." class="form-button w-button">FHCC</button>
        <button id="showUnitData" type="button" value="Submit" data-wait="Please wait..." class="form-button w-button bg-primary text-dark border-dark">Unit</button>
        <br><br>
        <table id="today-table" class="">

        </table>

        <div class="table-overlay border-dark bg-dark d-none" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)">
          <h3 class="saving" style="position:absolute;top:10%;left:50%;transform:translate(-50%,-50%);color:white;z-index:2">Loading Data</h3>
          <div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>
        </div>

        <div class="w-form-fail d-none">
          <div>Oops! Something went wrong while submitting the form.</div>
        </div>

      </div>



    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="  crossorigin="anonymous"></script>

    <script id="entry-template" type="text/x-handlebars-template">

      <ul class="list material-results">
        \{{#each this}}
          <li class="search-results">\{{@this}}</li>
        \{{/each}}
      </ul>

    </script>

    <script id="table-template" type="text/x-handlebars-template">

      <tr>
        <th>Project</th>
        <th>Works</th>
        <th>Quantity</th>
      </tr>

      \{{#each this}}
        \{{#if this.project}}

          <tr>
            <td>\{{project}}</td>
            <td>\{{works}}</td>
            <td>\{{quantity}}</td>
          </tr>

        \{{/if}}
      \{{/each}}



    </script>

    <script id="material-template" type="text/x-handlebars-template">

      \{{#if tabletitle}}
      <tr>
        <th colspan="3"><b>\{{tabletitle}}</b></th>
      </tr>
      \{{/if}}


      \{{#each this}}
        \{{#if this.project}}

          <tr>
            <td>\{{project}}</td>
            <td>\{{works}}</td>
            <td>\{{quantity}}</td>
          </tr>

        \{{/if}}
      \{{/each}}



    </script>

    <script>

      $('#email-form').on('submit',function(e) {
        e.preventDefault();
        let val = $("input[type='radio']:checked").val();
        if (!val) return $('.w-form-fail:eq(0)').addClass('d-block').html('Please select an input');
        $('.w-form-fail:eq(0)').removeClass('d-block');
        console.log(val);
        $('.new-form').removeClass('d-block').addClass('d-none');
        $(`.field-label:contains('${val}')`).closest('div').toggleClass('d-none d-block');
        $('.material-results').hide();
      });

      $('#email-form-2').on('submit',function(e) {
        e.preventDefault();
        $('.div-block-4:eq(-1)').clone().prependTo('.category-block');
        $('.div-block-4:eq(0)').removeClass('d-none').find('.bold-text-2').html(`Category: ${$(this).find('.field-label').html()}`);
        let data = {
          'Project Name': $('#const-projName').val() + '$' + $('#const-projName').attr('data-name'),
          'Responsibility': $('#const-resp').val() + '$' + $('#const-resp').attr('data-name'),
          'Work': $('#const-work').val() + '$' + $('#const-work').attr('data-name'),
          'Quantity': $('#const-qty').val() + '$' + $('#const-qty').attr('data-name'),
          'Unit': $('#const-unit').val() + '$' + $('#const-unit').attr('data-name'),
          'Remarks': $('#const-remarks').val() + '$' + $('#const-remarks').attr('data-name'),
        };

        dataNoted(data,this);

      });

      $('#email-form-3').on('submit',function(e) {
        e.preventDefault();
        $('.div-block-4:eq(-1)').clone().prependTo('.category-block');
        $('.div-block-4:eq(0)').removeClass('d-none').find('.bold-text-2').html(`Category: ${$(this).find('.field-label').html()}`);
        let data = {
          'Project Name': $('#ext-projName').val()+ '$' + $('#ext-projName').attr('data-name'),
          'Responsibility': $('#ext-resp').val()+ '$' + $('#ext-resp').attr('data-name'),
          'Work': $('#ext-work').val()+ '$' + $('#ext-work').attr('data-name'),
          'Quantity': $('#ext-qty').val()+ '$' + $('#ext-qty').attr('data-name'),
          'Unit': $('#ext-unit').val()+ '$' + $('#ext-unit').attr('data-name'),
          'Remarks': $('#ext-remarks').val()+ '$' + $('#ext-remarks').attr('data-name')
        };

        dataNoted(data,this);

      });

      $('#email-form-4').on('submit',function(e) {
        e.preventDefault();
        $('.div-block-4:eq(-1)').clone().prependTo('.category-block');
        $('.div-block-4:eq(0)').removeClass('d-none').find('.bold-text-2').html(`Category: ${$(this).find('.field-label').html()}`);
        let data = {
          'Bunker No': $('#bunker-projName').val() + '$' + $('#bunker-projName').attr('data-name'),
          'Responsibility': $('#bunker-resp').val() + '$' + $('#bunker-resp').attr('data-name'),
          'Work': $('#bunker-work').val() + '$' + $('#bunker-work').attr('data-name'),
          'Quantity': $('#bunker-qty').val() + '$' + $('#bunker-qty').attr('data-name'),
          'Unit': $('#bunker-unit').val() + '$' + $('#bunker-unit').attr('data-name'),
          'Remarks': $('#bunker-remarks').val() + '$' + $('#bunker-remarks').attr('data-name')
        };

        dataNoted(data,this);
      });

      $('#email-form-5').on('submit',function(e) {
        e.preventDefault();
        $('.div-block-4:eq(-1)').clone().prependTo('.category-block');
        $('.div-block-4:eq(0)').removeClass('d-none').find('.bold-text-2').html(`Category: ${$(this).find('.field-label').html()}`);
        let data = {
          'Project': $('#mat-name').val() + '$' + $('#mat-projName').attr('mat-name'),
          'Owner': $('#mat-resp').val() + '$' + $('#mat-resp').attr('data-name'),
          'Material': $('#mat-work').val() + '$' + $('#mat-work').attr('data-name'),
          'Quantity': $('#mat-qty').val() + '$' + $('#mat-qty').attr('data-name'),
          'Units': $('#mat-unit').val() + '$' + $('#mat-unit').attr('data-name'),
          'Remarks': $('#mat-remarks').val() + '$' + $('#mat-remarks').attr('data-name'),
        };

        dataNoted(data,this);

      });

      function dataNoted(data,element) {

        $(`.text-3:eq(-1)`).clone().appendTo('.div-block-5:eq(0)');

        let date = $('#upload-date').val().split("-").reverse().join("-");
        let location = $(element).find('select').val().split('&')[1];
        let newValue = $(element).find('select').val().split('&')[0];

        $('.div-block-4:eq(0)').find('.text-3:eq(-1)').children('span').data({myName: 'date'}).html(date).addClass('date-selected').siblings('strong').html('Date:');
        $('.div-block-4:eq(0)').find('.text-3:eq(-1)').children('span').html()

        $.each(data,function(key,value) {
          $(`.text-3:eq(-1)`).clone().appendTo('.div-block-5:eq(0)');
          $('.div-block-4:eq(0)').find('.text-3:eq(-1)').children('span').data({myName: value.split('$')[1]}).html(value.split('$')[0]).siblings('strong').html(key+': ');
        });

        $('.div-block-4:eq(0)').find('.text-3:eq(1)').children('span').addClass('location').html(newValue).data({location});

        $(element).find('select').each(function() {
          $(this).find('option:eq(0)').attr('selected',true);
        });

        $(element).find('input').each(function(){
          $(this).val('');
        });
      };

      $('.email-form-2-btn').on('click',function() {
        $(this).closest('div').toggleClass('d-none d-block');
      });

      // $(`.field-label:contains('New Construction')`).closest('div').toggleClass('d-none d-block');
      // $('#const-projName').val('Bunker 1 Washroom & FHCC');
      // $('#const-resp').val('MES');
      // $('#const-work').val('a lot of work done on foundations today');
      // $('#const-qty').val('300');
      // $('#const-unit').val('sft');
      // $('#const-remarks').val('it was their first day of work today');

      $(document).on('click','.btn-submit',function() {
        $(this).closest('.div-block-4').find('.overlay').toggleClass('d-none').css({
          height: $('.div-block-4').outerHeight(),
          width: $('.div-block-4').outerWidth()
        });
        $(this).closest('.div-block-4').find('.date-selected').closest('.text-3').removeClass('text-3');
        let category = $(this).closest('.div-block-4').find('.bold-text-2').html().split('Category: ')[1];
        // date','category','name','responsibility','work','quantity','unit','remarks'
        // "Thu Nov 29 2018 00:00:00 GMT+0500 (Pakistan Standard Time)", "11/29/2018", "FHCC", "Material In", "Bunkers", "Juke Box", "Cement", "50 Bags"]
        let date = $('#upload-date').val();
        let data = [
          new Date().toString(),
          $(this).closest('.div-block-4').find('.date-selected').html().split('-').reverse().join('-'),
          $(this).closest('.div-block-4').find('.location').data().location.trim(),
          category,
        ]
        let i = 4;
        $(this).closest('.div-block-4').find('.text-3').each(function() {
          // let key = $(this).children('span').data().myName;
          let value = $(this).children('span').html().trim();
          data[i] = value;
          i++
        });

        // console.log(JSON.parse(localStorage.data));
        // thisdata = JSON.parse(localStorage.data);
        // console.log(thisdata);
        // thisdata[thisdata.length] = data;
        // return console.log(thisdata);

        data = JSON.stringify(data);
        $.ajax({
            url: '/data',
            type: 'post',
            data,
            headers: {
                'content-type': 'application/json',
            }
          }).done((res) => {
            console.log(res);
            $(this).closest('.div-block-4').toggleClass('bg-success-light bg-secondary');
            $(this).html('Saved.!').attr('disabled',true).siblings('button').remove();
            $(this).closest('.div-block-4').find('.overlay').toggleClass('d-none');

            let mydata = JSON.parse(data);
            res2[res2.length] = mydata;
            showData(res2,mydata[2]);

          }).fail((e) => {
            console.log(e.responseText);
            $(this).closest('.div-block-4').find('.error').toggleClass('d-none').html(e.responseText);
            $(this).closest('.div-block-4').find('.overlay').toggleClass('d-none');
          });
      });

      $(document).on('click','.btn-delete',function() {
        $(this).closest('.div-block-4').remove();
      });

      $(document).on('mouseenter mouseleave','.search-results',function(){
        $(this).toggleClass('selected');
      });

      $(document).on('keyup','.search-input',function(){
        let val = $(this).val();
        if (val.length == 0) return;
        arr = $.grep(suggestions, function( n, i ) {
          n = n.toLowerCase();
          val = val.toLowerCase();
          return n.indexOf(val) !== -1;
        });
        compileHbs(arr);
        $(this).closest('form').find('.material-results').show();
      })

      function compileHbs(data) {
        var source   = document.getElementById("entry-template").innerHTML;
        var template = Handlebars.compile(source);
        var html    = template(data);
        $('.div-block-6').html(html);
      }

      let suggestions = [];
      let res2 = [];
      let fhccdata = {};
      let fhccmaterial = {};
      let unitdata = {};
      let unitmaterial = {};

      $(document).ready(() => {
        refreshData();

        // sortOldData();
        // $.ajax({
        //     url: '/getOldData',
        //     type: 'get',
        //     headers: {
        //         'content-type': 'application/json',
        //     }
        //   }).done((res) => {
        //     console.log(res);
        //     console.log('old data fetched !');
        //     // sortOldData(res);
        //     localStorage.data = JSON.stringify(res);
        //     sortOldData();
        //   }).fail((e) => {
        //     console.log(e.responseText);
        //   });
      });

      let sortedData = [];

      function sortOldData() {

        let dataWorks = JSON.parse(localStorage.data)[0].values;
        let dataMaterials = JSON.parse(localStorage.data)[1].values;
        sortOldWorksData(dataMaterials);
        sortOldWorksData(dataWorks);

        sortedData.sort(function(a, b){
            if(a[0] < b[0]) { return -1; }
            if(a[0] > b[0]) { return 1; }
            return 0;
        });

        $.each(sortedData,function(key,value){
          this[0] = value[0].toString();
        });

        sortedData = JSON.stringify(sortedData);
        console.log('ajax started');

        $.ajax({
            url: '/oldDataUpload',
            type: 'post',
            data: sortedData,
            headers: {
                'content-type': 'application/json',
            }
          }).done((res) => {
            console.log(res);
          }).fail((e) => {
            console.log(e.responseText);
          });

      }

      function sortOldWorksData(data) {
        let dates = data[1];
        let works = {};
        let obj = {};
        let index = '';
        let eachWork = {};
        $.each(data,function(key,value){
          if (!value[0]) return;
          if (value[0].indexOf('Bunker') != -1 || value[0].indexOf('Mosque') != -1 || value[0].indexOf('Entrance Main Gate') != -1 || value[0].indexOf('FHCC Pathways') != -1 || value[0].indexOf('OFC / UG Laying') != -1 || value[0] == 'Drain') {
            eachWork = {};
            return index = value[0];
          };
          if (!index) return;
          obj = {};
          $.each(value,function(nKey,nValue) {
            if (!nValue || nKey == 0 || nKey == 1) return;
            let prop = dates[nKey];
            obj[prop] = nValue;
          });

          eachWork[value[0]] = obj;
          works[index] = eachWork;
        });

        $.each(works,function(key,value){
          $.each(value,function(nKey,nValue){
            $.each(nValue,function(mKey,mValue){
              let arr = [];
              arr[0] = new Date(mKey);
              arr[1] = mKey;
              arr[2] = 'FHCC';
              arr[3] = ''; // 'Bunkers Works (FHCC)',
              arr[4] = key;
              arr[5] = ''; // 'Juke Box',
              arr[6] = nKey;
              arr[7] = mValue;

              if (key.indexOf('Bunkers') != -1) {
                arr[3] = 'Material In';
                arr[5] = 'Juke Box';
              } else if (key.indexOf('Pathways') != -1) {
                arr[3] = 'New Construction';
                arr[5] = 'MES';
              } else if (key.indexOf('OFC / UG') != -1) {
                arr[3] = 'New Construction';
                arr[5] = 'Pak Arab';
              } else {
                arr[3] = 'Bunkers Works (FHCC)';
                arr[5] = 'Juke Box';
              }

              sortedData.push(arr);
            })
          })
        });

        return sortedData;

      };

      function refreshData() {
        $('.table-overlay').closest('.form').find('.w-form-fail').removeClass('d-block').addClass('d-none');
        $('.table-overlay').removeClass('d-none').css({
          height: $('.table-overlay').closest('.form').outerHeight(),
          width: $('.table-overlay').closest('.form').outerWidth()
        });

        // res2 = JSON.parse(localStorage.data);
        // showData(res2);
        // $('.table-overlay').addClass('d-none');

        $.ajax({
            url: '/getSuggestions',
            type: 'get',
            headers: {
                'content-type': 'application/json',
            }
          }).done((msg) => {
            $('.table-overlay').addClass('d-none');
            let res = msg[1].values;
            $.each(res,function(key,value) {
              suggestions[key] = value[0]
            });

            suggestions = unique(suggestions);
            // localStorage.data = JSON.stringify(msg[0].values);
            res2 = msg[0].values;
            console.log(res2);
            showData(res2);

          }).fail((e) => {
            $('.table-overlay').addClass('d-none');
            console.log(e.responseText);
            $('.table-overlay').closest('.form').find('.w-form-fail').toggleClass('d-none d-block').html(e.responseText);
          });
      };

      function showData(data,location) {

        fhccdata = {};
        fhccmaterial = {};
        unitdata = {};
        unitmaterial = {};

        let rows = [];
        let date = $('#upload-date').val();

        arr = $.grep(data, function( n, i ) {
          let dataDate = new Date(n[1]).toString().slice(0,15);
          let valueDate = new Date(date).toString().slice(0,15);
          return dataDate.indexOf(valueDate) != -1;
        });

        if (!arr.length) {
          return $('#today-table').html('').siblings('.w-form-fail').removeClass('d-none').addClass('d-block').html('Sorry no data found for this date.');
        }

        arr.sort(function(a, b){
            if(a[4] < b[4]) { return -1; }
            if(a[4] > b[4]) { return 1; }
            return 0;
        });

        arr.sort(function(a, b){
            if(a[3] < b[3]) { return -1; }
            if(a[3] > b[3]) { return 1; }
            return 0;
        });

        let fhcc = $.grep(arr,function(n,i){
          return n[2].indexOf('FHCC') !== -1;
        });

        let unit = $.grep(arr,function(n,i){
          return n[2].indexOf('Unit') !== -1;
        });

        let i = 0;
        $.each(fhcc,function(key,value) {

          let myunit = value[8] || '';

          if (value[3] == 'Material In') {
            fhccmaterial[i] = {
              type: value[3],
              project: value[4],
              works: value[6],
              quantity: value[7] + ' ' + myunit,
            };
            return i++;
          };

          fhccdata[key] = {
            type: value[3],
            project: value[4],
            works: value[6],
            quantity: value[7] + ' ' + myunit,
          };
        });

        i = 0;

        $.each(unit,function(key,value) {

          let myunit2 = value[8] || '';

          if (value[3] == 'Material In') {
            unitmaterial[i] = {
              type: value[3],
              project: value[4],
              works: value[6],
              quantity: value[7] + ' ' + myunit2,
            };
            return i++;
          };
          unitdata[key] = {
            type: value[3],
            project: value[4],
            works: value[6],
            quantity: value[7] + ' ' + myunit2,
          }
        });

        fhccmaterial.tabletitle = 'Materials Entered';
        unitmaterial.tabletitle = 'Materials Entered';

        let loc = location || 'FHCC';
        console.log(loc);
        if (loc == 'FHCC') {
          compileTableHbs(fhccdata);
          compileMaterialHbs(fhccmaterial);
        } else {
          compileTableHbs(unitdata);
          compileMaterialHbs(unitmaterial);
        };

      }

      $('#showFHCCData').on('click',function(){
        $(this).removeClass('bg-primary text-dark border-dark');
        $(this).siblings('button').addClass('bg-primary text-dark border-dark');
        compileTableHbs(fhccdata);
        compileMaterialHbs(fhccmaterial);
      });

      $('#showUnitData').on('click',function(){
        $(this).removeClass('bg-primary text-dark border-dark');
        $(this).siblings('button').addClass('bg-primary text-dark border-dark');
        compileTableHbs(unitdata);
        compileMaterialHbs(unitmaterial);
      });

      $('#upload-date').on('change',function(){
        let loc;
        if ($('#showUnitData').attr('class').indexOf('bg-primary') == -1) {
          loc = 'unit';
        } else {
          loc = 'FHCC';
        }
        showData(res2,loc);
      })

      function compileTableHbs(data) {
        $('#today-table').siblings('.w-form-fail').removeClass('d-block').addClass('d-none');
        var source   = document.getElementById("table-template").innerHTML;
        var template = Handlebars.compile(source);
        var html    = template(data);
        $('#today-table').html(html);
      }

      function compileMaterialHbs(data) {
        $('#today-table').siblings('.w-form-fail').removeClass('d-block').addClass('d-none');
        var source   = document.getElementById("material-template").innerHTML;
        var template = Handlebars.compile(source);
        var html    = template(data);
        $('#today-table').append(html);
      }

      function unique(list) {
        var result = [];

        $.each(list, function(i, e) {
          if ($.inArray(e, result) == -1) result.push(e);
        });
        return result;
      };

      $(document).on('click','.selected',function(){
        let myValue = $(this).html();
        $(this).closest('form').find('.search-input').val(myValue);
        $(this).closest('.material-results').hide();
      })

    </script>

  </body>

</html>
